<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ page.title | default: "ModelHaven Studio" }}</title>

<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>

<body>
<div class="wrap">
  <main class="prose">
            {{ content }}
  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({ startOnLoad: true });

document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll("pre > code.language-mermaid").forEach((code) => {
    const pre = code.parentElement;
    const div = document.createElement("div");
    div.className = "mermaid";
    div.textContent = code.textContent;
    pre.replaceWith(div);
  });
  mermaid.init(undefined, document.querySelectorAll(".mermaid"));
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {

  document.querySelectorAll(".collapsible").forEach(card => {

    const toggle = card.querySelector(".collapse-toggle");
    const content = card.querySelector(".collapse-content");

    if (!toggle || !content) return;

    let isAnimating = false;

    toggle.setAttribute("role", "button");
    toggle.setAttribute("tabindex", "0");
    toggle.setAttribute("aria-expanded", "false");

    if (!toggle.querySelector(".chev")) {
      const chev = document.createElement("span");
      chev.className = "chev";
      chev.textContent = "â–¸";
      toggle.prepend(chev);
    }

    function open() {
      if (isAnimating) return;
      isAnimating = true;

      card.classList.add("open");
      toggle.setAttribute("aria-expanded", "true");

      content.style.height = "0px";
      content.style.opacity = "1";
      content.offsetHeight;
      content.style.height = content.scrollHeight + "px";
    }

    function close() {
      if (isAnimating) return;
      isAnimating = true;

      content.style.height = content.scrollHeight + "px";
      content.offsetHeight;
      content.style.height = "0px";
      content.style.opacity = "0";

      card.classList.remove("open");
      toggle.setAttribute("aria-expanded", "false");
    }

    content.addEventListener("transitionend", (e) => {
      if (e.propertyName !== "height") return;

      if (card.classList.contains("open")) {
        content.style.height = "auto";
        content.style.opacity = "1";
      }

      isAnimating = false;
    });

    toggle.addEventListener("click", () => {
      card.classList.contains("open") ? close() : open();
    });

    toggle.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        card.classList.contains("open") ? close() : open();
      }
    });

    content.style.height = "0px";
    content.style.opacity = "0";

  });

});
</script>
<script>
document.querySelectorAll('.card.collapsible.is-collapsible').forEach((card) => {
  const toggle = card.querySelector('.collapse-toggle');
  const content = card.querySelector('.collapse-content');
  if (!toggle || !content) return;

  // Make <h3> behave like a button (same as hospitality vibe)
  toggle.setAttribute('role', 'button');
  toggle.setAttribute('tabindex', '0');
  toggle.setAttribute('aria-expanded', 'false');

  // init closed
  content.hidden = true;
  content.style.height = '0px';

  const setOpen = (open) => {
    card.classList.toggle('is-open', open);
    toggle.setAttribute('aria-expanded', String(open));

    if (open) {
      content.hidden = false;

      // open: 0 -> scrollHeight -> auto
      content.style.height = '0px';
      const h = content.scrollHeight;
      content.style.height = h + 'px';

      const onEnd = (e) => {
        if (e.propertyName === 'height') {
          content.style.height = 'auto';
          content.removeEventListener('transitionend', onEnd);
        }
      };
      content.addEventListener('transitionend', onEnd);

    } else {
      // close: auto -> px -> 0 -> hidden
      const current = content.scrollHeight;
      content.style.height = current + 'px';

      requestAnimationFrame(() => {
        content.style.height = '0px';
      });

      const onEnd = (e) => {
        if (e.propertyName === 'height') {
          content.hidden = true;
          content.removeEventListener('transitionend', onEnd);
        }
      };
      content.addEventListener('transitionend', onEnd);
    }
  };

  toggle.addEventListener('click', () => {
    const open = toggle.getAttribute('aria-expanded') === 'true';
    setOpen(!open);
  });

  toggle.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      toggle.click();
    }
  });
});
</script>

</body>
</html>